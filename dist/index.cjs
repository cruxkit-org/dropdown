'use strict';var jsx=require('@minejs/jsx'),button=require('@cruxkit/button'),icon=require('@cruxkit/icon'),jsxRuntime=require('@minejs/jsx/jsx-runtime');var S=null;function g(e){let t=e,r=new Set;function n(){return S&&r.add(S),t}function i(u){Object.is(t,u)||(t=u,r.forEach(c=>c()));}function v(u){i(u(t));}function f(){return t}function E(u){return r.add(u),()=>r.delete(u)}let b=n;return b.set=i,b.update=v,b.peek=f,b.subscribe=E,b}function y(e){let t,r=false,n=()=>{if(r)return;t&&(t(),t=void 0);let v=S;S=n;try{let f=e();typeof f=="function"&&(t=f);}finally{S=v;}};n();let i=()=>{r||(r=true,t&&t());};return i}var N=class{constructor(){this.instances=g([]);}register(t,r,n=null){let i=this.calculateLevel(n),v={id:t,parentId:n,close:r,level:i};this.instances.update(f=>[...f,v]);}unregister(t){this.instances.update(r=>r.filter(n=>n.id!==t));}open(t){let r=this.instances().find(i=>i.id===t);if(!r){console.warn("[DropdownManager] Cannot open - dropdown not found:",t);return}this.instances().filter(i=>i.id!==t&&i.level===r.level&&i.parentId===r.parentId).forEach(i=>{i.close();});}close(t){let r=this.instances().find(i=>i.id===t);if(!r)return;this.getChildren(t).forEach(i=>{i.close();}),r.close();}closeFromLevel(t){this.instances().filter(n=>n.level>=t).forEach(n=>{n.close();});}getChildren(t){let r=this.instances().filter(i=>i.parentId===t),n=[...r];return r.forEach(i=>{n.push(...this.getChildren(i.id));}),n}calculateLevel(t){if(!t)return 0;let r=this.instances().find(n=>n.id===t);return r?r.level+1:0}isAncestor(t,r){let n=this.instances().find(i=>i.id===r);for(;n&&n.parentId;){if(n.parentId===t)return  true;n=this.instances().find(i=>i.id===n.parentId);}return  false}getRootParent(t){let r=this.instances().find(n=>n.id===t);for(;r&&r.parentId;)r=this.instances().find(n=>n.id===r.parentId);return r||null}debug(){console.log("[DropdownManager] Registered dropdowns:",this.instances());}},w=new N;var W={sm:{text:"sm",paddingX:3,paddingY:1},md:{text:"md",paddingX:4,paddingY:2},lg:{text:"lg",paddingX:5,paddingY:3}},_={start:"start-0",center:"start-1/2 -translate-x-1/2",end:"end-0"},D={down:{menu:"top-full",arrow:"bottom-full mb-1"},up:{menu:"bottom-full",arrow:"top-full mt-1"},side:{menu:"top-0 start-full ms-2",arrow:"top-1/2 end-full me-1 -translate-y-1/2"}},ee="div",Y=e=>e==="up"?{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid var(--border-1)",borderTop:"0",top:""}:e==="side"?{width:"0",height:"0",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderInlineStart:"6px solid var(--border-1)",borderInlineEnd:"0",top:""}:{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"6px solid var(--border-1)",borderBottom:"0",top:"-7px"};function pe(e){let t=e.size||"md",r=e.position||"end",n=e.direction||"down",i=e.triggerMode||"click",v=e.triggerDisplay||"label-icon",f=e.hoverDelay||150,E=e.styleMode||"arrow",b=e.variant||"ghost",u=e.color||"neutral",c=e.id||`dropdown-${Math.random().toString(36).substr(2,9)}`,F=e.parentId||null,m=g(false),R=g(n),h=null,O=g(null),M=g(null),I=g(null),B=g(null);y(()=>{e.onOpenChange?.(m());});let q=Y(n);w.register(c,()=>{m.set(false);},F),y(()=>()=>{w.unregister(c),h&&clearTimeout(h);}),y(()=>{if(!m())return;let s=l=>{let a=M();a&&!a.contains(l.target)&&w.close(c);};return document.addEventListener("click",s),()=>{document.removeEventListener("click",s);}});let H=()=>{let o=I(),s=M();if(!o||!s)return;let l=s.getBoundingClientRect(),a=o.classList.contains("hidden");a&&(o.style.visibility="hidden",o.classList.remove("hidden"),o.classList.add("flex"));let p=o.getBoundingClientRect(),T=window.innerWidth,U=window.innerHeight;a&&(o.classList.remove("flex"),o.classList.add("hidden"),o.style.visibility="");let L=k=>k==="down"?l.bottom+p.height+10<=U:k==="up"?l.top-p.height-10>=0:k==="side"?l.right+p.width+10<=T:false,x=n;L(x)||(L("down")?x="down":L("up")?x="up":L("side")&&(x="side")),R.set(x);},j=o=>{o.stopPropagation(),!m()?(H(),w.open(c),m.set(true)):w.close(c);},z=()=>{h&&clearTimeout(h),h=setTimeout(()=>{H(),w.open(c),m.set(true);},f);},$=()=>{h&&clearTimeout(h),h=setTimeout(()=>{w.close(c);},f);},G=(o,s)=>{s||(e.onSelect?.(o),w.close(c));};y(()=>{let o=m(),s=I();s&&(o?(s.classList.remove("hidden"),s.classList.add("flex")):(s.classList.remove("flex"),s.classList.add("hidden")));}),y(()=>{let o=R(),s=I();if(!s)return;Object.values(D).forEach(a=>{a.menu.split(" ").forEach(p=>s.classList.remove(p));}),D[o].menu.split(" ").forEach(a=>s.classList.add(a));let l=B();if(l&&E==="arrow"&&e.labelArrow){Object.values(D).forEach(p=>{p.arrow.split(" ").forEach(T=>l.classList.remove(T));}),D[o].arrow.split(" ").forEach(p=>l.classList.add(p));let a=Y(o);Object.assign(l.style,a),o!=="down"&&(l.style.top=""),o==="down"&&(l.style.top="-7px");}}),y(()=>{let o=m(),s=O();s&&(o?s.classList.add("rotate-180"):s.classList.remove("rotate-180"));});let K=()=>{let o=e.triggerIcon?typeof e.triggerIcon=="string"?jsxRuntime.jsx(icon.Icon,{name:e.triggerIcon,size:"md"}):jsxRuntime.jsx(icon.Icon,{...e.triggerIcon}):null,s=()=>e.labelArrow?jsxRuntime.jsx("span",{ref:O,className:"transition-transform duration-200 flex items-center",children:jsxRuntime.jsx(icon.Icon,{name:"angle-down",size:"xxs"})}):null,l=typeof e.trigger=="string"?jsxRuntime.jsx("div",{as:"span",w:"full",justify:"between",display:"inline-flex",textSize:W[t].text,children:e.trigger}):e.trigger;switch(v){case "icon-only":return jsxRuntime.jsx("div",{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:o||s()});case "label-only":return jsxRuntime.jsxs("div",{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:[l,s()]});case "icon-label":return jsxRuntime.jsxs("div",{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:[l,o,s()]});case "label-icon":default:return jsxRuntime.jsxs("div",{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:[l,o,s()]})}},Q=(()=>{switch(i){case "hover":return {onMouseEnter:z,onMouseLeave:$};case "both":return {onClick:j,onMouseEnter:z,onMouseLeave:$};case "click":default:return {onClick:j}}})();return jsxRuntime.jsxs("div",{ref:M,className:"dropdown relative inline-block",...i==="hover"||i==="both"?{onMouseEnter:z,onMouseLeave:$}:{},children:[jsxRuntime.jsx(button.Button,{variant:b,color:u,size:t,className:`${e.className||""} ${e.buttonClassName||""} w-full`,...Q,fullWidth:true,labelFullWidth:true,children:typeof e.trigger=="string"?K():jsxRuntime.jsx("div",{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:e.trigger})}),jsxRuntime.jsx(ee,{as:"div",display:"flex",direction:"column",className:`
                        dropdown-menu
                        absolute
                        ${D[n].menu}
                        ${_[r]}
                        hidden
                        bg-surface
                        shadow-lg
                        z-50
                        py-1
                        ${E==="partof"?"w-full min-w-fit rounded-none border-x border-b border-1 mt-0":`w-full min-w-fit rounded-md border border-1 ${n==="down"?"mt-2":""} ${n==="up"?"mb-2":""}`}
                    `,ref:I,children:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[E==="arrow"&&e.labelArrow&&jsxRuntime.jsx("div",{ref:B,className:`
                                        absolute
                                        ${D[n].arrow}
                                    `,style:q}),e.options.flatMap((o,s)=>{let l=[];o.divider?l.push(jsxRuntime.jsx(jsx.Divider,{spacing:1})):l.push(jsxRuntime.jsx(button.Button,{variant:"ghost",color:u,size:t,fullWidth:true,className:`
                                                dropdown-option
                                                justify-start
                                                text-base
                                                text-1
                                                whitespace-nowrap
                                                ${o.disabled?"opacity-50 cursor-not-allowed pointer-events-none":""}
                                            `,onClick:()=>G(o.value,o.disabled),disabled:o.disabled,leftIcon:o.icon,type:"button",children:o.label}));let a=e.options[s+1];return e.autoDivider&&s<e.options.length-1&&!o.divider&&(!a||!a.divider)&&l.push(jsxRuntime.jsx(jsx.Divider,{className:"my-1"})),l})]})})]})}exports.Dropdown=pe;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map