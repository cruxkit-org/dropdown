'use strict';var container=require('@cruxkit/container'),button=require('@cruxkit/button'),text=require('@cruxkit/text'),divider=require('@cruxkit/divider'),icon=require('@cruxkit/icon'),jsxRuntime=require('@minejs/jsx/jsx-runtime');var L=null;function S(t){let e=t,r=new Set;function n(){return L&&r.add(L),e}function i(u){Object.is(e,u)||(e=u,r.forEach(c=>c()));}function w(u){i(u(e));}function f(){return e}function x(u){return r.add(u),()=>r.delete(u)}let v=n;return v.set=i,v.update=w,v.peek=f,v.subscribe=x,v}function y(t){let e,r=false,n=()=>{if(r)return;e&&(e(),e=void 0);let w=L;L=n;try{let f=t();typeof f=="function"&&(e=f);}finally{L=w;}};n();let i=()=>{r||(r=true,e&&e());};return i}var P=class{constructor(){this.instances=S([]);}register(e,r,n=null){let i=this.calculateLevel(n),w={id:e,parentId:n,close:r,level:i};this.instances.update(f=>[...f,w]);}unregister(e){this.instances.update(r=>r.filter(n=>n.id!==e));}open(e){let r=this.instances().find(i=>i.id===e);if(!r){console.warn("[DropdownManager] Cannot open - dropdown not found:",e);return}this.instances().filter(i=>i.id!==e&&i.level===r.level&&i.parentId===r.parentId).forEach(i=>{i.close();});}close(e){let r=this.instances().find(i=>i.id===e);if(!r)return;this.getChildren(e).forEach(i=>{i.close();}),r.close();}closeFromLevel(e){this.instances().filter(n=>n.level>=e).forEach(n=>{n.close();});}getChildren(e){let r=this.instances().filter(i=>i.parentId===e),n=[...r];return r.forEach(i=>{n.push(...this.getChildren(i.id));}),n}calculateLevel(e){if(!e)return 0;let r=this.instances().find(n=>n.id===e);return r?r.level+1:0}isAncestor(e,r){let n=this.instances().find(i=>i.id===r);for(;n&&n.parentId;){if(n.parentId===e)return  true;n=this.instances().find(i=>i.id===n.parentId);}return  false}getRootParent(e){let r=this.instances().find(n=>n.id===e);for(;r&&r.parentId;)r=this.instances().find(n=>n.id===r.parentId);return r||null}debug(){console.log("[DropdownManager] Registered dropdowns:",this.instances());}},p=new P;var W={sm:{text:"sm",paddingX:3,paddingY:1},md:{text:"md",paddingX:4,paddingY:2},lg:{text:"lg",paddingX:5,paddingY:3}},ee={start:"start-0",center:"start-1/2 -translate-x-1/2",end:"end-0"},D={down:{menu:"top-full",arrow:"bottom-full mb-1"},up:{menu:"bottom-full",arrow:"top-full mt-1"},side:{menu:"top-0 start-full ms-2",arrow:"top-1/2 end-full me-1 -translate-y-1/2"}},te=container.Container,Y=t=>t==="up"?{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid var(--border-1)",borderTop:"0",top:""}:t==="side"?{width:"0",height:"0",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderInlineStart:"6px solid var(--border-1)",borderInlineEnd:"0",top:""}:{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"6px solid var(--border-1)",borderBottom:"0",top:"-7px"};function he(t){let e=t.size||"md",r=t.position||"end",n=t.direction||"down",i=t.triggerMode||"click",w=t.triggerDisplay||"label-icon",f=t.hoverDelay||150,x=t.styleMode||"arrow",v=t.variant||"ghost",u=t.color||"neutral",c=t.id||`dropdown-${Math.random().toString(36).substr(2,9)}`,J=t.parentId||null,g=S(false),N=S(n),m=null,M=null,C=null,a=null,b=null;y(()=>{t.onOpenChange?.(g());});let F=Y(n);p.register(c,()=>{g.set(false);},J),y(()=>()=>{p.unregister(c),m&&clearTimeout(m);}),y(()=>{if(!g())return;let s=l=>{C&&!C.contains(l.target)&&p.close(c);};return document.addEventListener("click",s),()=>{document.removeEventListener("click",s);}});let O=()=>{if(!a||!C)return;let o=C.getBoundingClientRect(),s=a.classList.contains("hidden");s&&(a.style.visibility="hidden",a.classList.remove("hidden"),a.classList.add("flex"));let l=a.getBoundingClientRect(),h=window.innerWidth,U=window.innerHeight;s&&(a.classList.remove("flex"),a.classList.add("hidden"),a.style.visibility="");let T=H=>H==="down"?o.bottom+l.height+10<=U:H==="up"?o.top-l.height-10>=0:H==="side"?o.right+l.width+10<=h:false,E=n;T(E)||(T("down")?E="down":T("up")?E="up":T("side")&&(E="side")),N.set(E);},B=o=>{o.stopPropagation(),!g()?(O(),p.open(c),g.set(true)):p.close(c);},k=()=>{m&&clearTimeout(m),m=setTimeout(()=>{O(),p.open(c),g.set(true);},f);},$=()=>{m&&clearTimeout(m),m=setTimeout(()=>{p.close(c);},f);},q=(o,s)=>{s||(t.onSelect?.(o),p.close(c));};y(()=>{let o=g();a&&(o?(a.classList.remove("hidden"),a.classList.add("flex")):(a.classList.remove("flex"),a.classList.add("hidden")));}),y(()=>{let o=N();if(a&&(Object.values(D).forEach(s=>{s.menu.split(" ").forEach(l=>a.classList.remove(l));}),D[o].menu.split(" ").forEach(s=>a.classList.add(s)),b&&x==="arrow"&&t.labelArrow)){Object.values(D).forEach(l=>{l.arrow.split(" ").forEach(h=>b.classList.remove(h));}),D[o].arrow.split(" ").forEach(l=>b.classList.add(l));let s=Y(o);Object.assign(b.style,s),o!=="down"&&(b.style.top=""),o==="down"&&(b.style.top="-7px");}}),y(()=>{let o=g();M&&(o?M.classList.add("rotate-180"):M.classList.remove("rotate-180"));});let G=()=>{let o=t.triggerIcon?typeof t.triggerIcon=="string"?jsxRuntime.jsx(icon.Icon,{name:t.triggerIcon,size:"md"}):jsxRuntime.jsx(icon.Icon,{...t.triggerIcon}):null,s=()=>t.labelArrow?jsxRuntime.jsx("span",{ref:h=>{M=h;},className:"transition-transform duration-200 flex items-center",children:jsxRuntime.jsx(icon.Icon,{name:"caret-down",size:"xs"})}):null,l=typeof t.trigger=="string"?jsxRuntime.jsx(text.Text,{as:"span",size:W[e].text,children:t.trigger}):t.trigger;switch(w){case "icon-only":return jsxRuntime.jsx(container.Container,{as:"span",display:"inline-flex",align:"center",gap:1,children:o||s()});case "label-only":return jsxRuntime.jsxs(container.Container,{as:"span",display:"inline-flex",align:"center",gap:2,children:[l,s()]});case "label-icon":default:return jsxRuntime.jsxs(container.Container,{as:"span",display:"inline-flex",align:"center",gap:2,children:[o,l,s()]})}},K=(()=>{switch(i){case "hover":return {onMouseEnter:k,onMouseLeave:$};case "both":return {onClick:B,onMouseEnter:k,onMouseLeave:$};case "click":default:return {onClick:B}}})(),Q=W[e];return jsxRuntime.jsxs("div",{ref:o=>{C=o;},className:"dropdown relative inline-block",...i==="hover"||i==="both"?{onMouseEnter:k,onMouseLeave:$}:{},children:[jsxRuntime.jsx(button.Button,{variant:v,color:u,size:e,className:t.className,...K,children:jsxRuntime.jsx(container.Container,{as:"span",display:"inline-flex",align:"center",gap:Q.text==="sm"?1:2,children:typeof t.trigger=="string"?G():t.trigger})}),jsxRuntime.jsx(te,{as:"div",display:"flex",direction:"column",className:`
                        dropdown-menu
                        absolute
                        ${D[n].menu}
                        ${ee[r]}
                        hidden
                        bg-surface
                        shadow-lg
                        z-50
                        py-1
                        ${x==="partof"?"w-full min-w-fit rounded-none border-x border-b border-1 mt-0":`w-full min-w-fit rounded-md border border-1 ${n==="down"?"mt-2":""} ${n==="up"?"mb-2":""}`}
                    `,ref:o=>{a=o;},children:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[x==="arrow"&&t.labelArrow&&jsxRuntime.jsx("div",{ref:o=>{b=o;},className:`
                                        absolute
                                        ${D[n].arrow}
                                    `,style:F}),t.options.flatMap((o,s)=>{let l=[];o.divider?l.push(jsxRuntime.jsx(divider.Divider,{color:"1",opacity:50,max:100,thickness:"super-thin",className:"my-1"})):l.push(jsxRuntime.jsx(button.Button,{variant:"ghost",color:u,size:e,fullWidth:true,className:`
                                                dropdown-option
                                                justify-start
                                                text-base
                                                text-1
                                                whitespace-nowrap
                                                ${o.disabled?"opacity-50 cursor-not-allowed pointer-events-none":""}
                                            `,onClick:()=>q(o.value,o.disabled),disabled:o.disabled,leftIcon:o.icon,type:"button",children:o.label}));let h=t.options[s+1];return t.autoDivider&&s<t.options.length-1&&!o.divider&&(!h||!h.divider)&&l.push(jsxRuntime.jsx(divider.Divider,{color:"1",opacity:50,max:100,thickness:"super-thin",className:"my-1"})),l})]})})]})}exports.Dropdown=he;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map