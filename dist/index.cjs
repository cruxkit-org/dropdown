'use strict';var container=require('@cruxkit/container'),button=require('@cruxkit/button'),text=require('@cruxkit/text'),divider=require('@cruxkit/divider'),icon=require('@cruxkit/icon'),jsxRuntime=require('@minejs/jsx/jsx-runtime');var S=null;function M(e){let t=e,r=new Set;function n(){return S&&r.add(S),t}function i(u){Object.is(t,u)||(t=u,r.forEach(c=>c()));}function h(u){i(u(t));}function f(){return t}function C(u){return r.add(u),()=>r.delete(u)}let b=n;return b.set=i,b.update=h,b.peek=f,b.subscribe=C,b}function y(e){let t,r=false,n=()=>{if(r)return;t&&(t(),t=void 0);let h=S;S=n;try{let f=e();typeof f=="function"&&(t=f);}finally{S=h;}};n();let i=()=>{r||(r=true,t&&t());};return i}var H=class{constructor(){this.instances=M([]);}register(t,r,n=null){let i=this.calculateLevel(n),h={id:t,parentId:n,close:r,level:i};this.instances.update(f=>[...f,h]);}unregister(t){this.instances.update(r=>r.filter(n=>n.id!==t));}open(t){let r=this.instances().find(i=>i.id===t);if(!r){console.warn("[DropdownManager] Cannot open - dropdown not found:",t);return}this.instances().filter(i=>i.id!==t&&i.level===r.level&&i.parentId===r.parentId).forEach(i=>{i.close();});}close(t){let r=this.instances().find(i=>i.id===t);if(!r)return;this.getChildren(t).forEach(i=>{i.close();}),r.close();}closeFromLevel(t){this.instances().filter(n=>n.level>=t).forEach(n=>{n.close();});}getChildren(t){let r=this.instances().filter(i=>i.parentId===t),n=[...r];return r.forEach(i=>{n.push(...this.getChildren(i.id));}),n}calculateLevel(t){if(!t)return 0;let r=this.instances().find(n=>n.id===t);return r?r.level+1:0}isAncestor(t,r){let n=this.instances().find(i=>i.id===r);for(;n&&n.parentId;){if(n.parentId===t)return  true;n=this.instances().find(i=>i.id===n.parentId);}return  false}getRootParent(t){let r=this.instances().find(n=>n.id===t);for(;r&&r.parentId;)r=this.instances().find(n=>n.id===r.parentId);return r||null}debug(){console.log("[DropdownManager] Registered dropdowns:",this.instances());}},p=new H;var A={sm:{text:"sm",paddingX:3,paddingY:1},md:{text:"md",paddingX:4,paddingY:2},lg:{text:"lg",paddingX:5,paddingY:3}},_={start:"start-0",center:"start-1/2 -translate-x-1/2",end:"end-0"},D={down:{menu:"top-full",arrow:"bottom-full mb-1"},up:{menu:"bottom-full",arrow:"top-full mt-1"},side:{menu:"top-0 start-full ms-2",arrow:"top-1/2 end-full me-1 -translate-y-1/2"}},ee=container.Container,Y=e=>e==="up"?{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid var(--border-1)",borderTop:"0",top:""}:e==="side"?{width:"0",height:"0",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderInlineStart:"6px solid var(--border-1)",borderInlineEnd:"0",top:""}:{width:"0",height:"0",borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"6px solid var(--border-1)",borderBottom:"0",top:"-7px"};function me(e){let t=e.size||"md",r=e.position||"end",n=e.direction||"down",i=e.triggerMode||"click",h=e.triggerDisplay||"label-icon",f=e.hoverDelay||150,C=e.styleMode||"arrow",b=e.variant||"ghost",u=e.color||"neutral",c=e.id||`dropdown-${Math.random().toString(36).substr(2,9)}`,J=e.parentId||null,g=M(false),R=M(n),m=null,T=null,E=null,a=null,v=null;y(()=>{e.onOpenChange?.(g());});let F=Y(n);p.register(c,()=>{g.set(false);},J),y(()=>()=>{p.unregister(c),m&&clearTimeout(m);}),y(()=>{if(!g())return;let s=l=>{E&&!E.contains(l.target)&&p.close(c);};return document.addEventListener("click",s),()=>{document.removeEventListener("click",s);}});let O=()=>{if(!a||!E)return;let o=E.getBoundingClientRect(),s=a.classList.contains("hidden");s&&(a.style.visibility="hidden",a.classList.remove("hidden"),a.classList.add("flex"));let l=a.getBoundingClientRect(),w=window.innerWidth,Q=window.innerHeight;s&&(a.classList.remove("flex"),a.classList.add("hidden"),a.style.visibility="");let z=N=>N==="down"?o.bottom+l.height+10<=Q:N==="up"?o.top-l.height-10>=0:N==="side"?o.right+l.width+10<=w:false,L=n;z(L)||(z("down")?L="down":z("up")?L="up":z("side")&&(L="side")),R.set(L);},j=o=>{o.stopPropagation(),!g()?(O(),p.open(c),g.set(true)):p.close(c);},$=()=>{m&&clearTimeout(m),m=setTimeout(()=>{O(),p.open(c),g.set(true);},f);},k=()=>{m&&clearTimeout(m),m=setTimeout(()=>{p.close(c);},f);},q=(o,s)=>{s||(e.onSelect?.(o),p.close(c));};y(()=>{let o=g();a&&(o?(a.classList.remove("hidden"),a.classList.add("flex")):(a.classList.remove("flex"),a.classList.add("hidden")));}),y(()=>{let o=R();if(a&&(Object.values(D).forEach(s=>{s.menu.split(" ").forEach(l=>a.classList.remove(l));}),D[o].menu.split(" ").forEach(s=>a.classList.add(s)),v&&C==="arrow"&&e.labelArrow)){Object.values(D).forEach(l=>{l.arrow.split(" ").forEach(w=>v.classList.remove(w));}),D[o].arrow.split(" ").forEach(l=>v.classList.add(l));let s=Y(o);Object.assign(v.style,s),o!=="down"&&(v.style.top=""),o==="down"&&(v.style.top="-7px");}}),y(()=>{let o=g();T&&(o?T.classList.add("rotate-180"):T.classList.remove("rotate-180"));});let G=()=>{let o=e.triggerIcon?typeof e.triggerIcon=="string"?jsxRuntime.jsx(icon.Icon,{name:e.triggerIcon,size:"md"}):jsxRuntime.jsx(icon.Icon,{...e.triggerIcon}):null,s=()=>e.labelArrow?jsxRuntime.jsx("span",{ref:w=>{T=w;},className:"transition-transform duration-200 flex items-center",children:jsxRuntime.jsx(icon.Icon,{name:"angle-down",size:"xxs"})}):null,l=typeof e.trigger=="string"?jsxRuntime.jsx(text.Text,{as:"span",className:"w-full justify-between",size:A[t].text,children:e.trigger}):e.trigger;switch(h){case "icon-only":return jsxRuntime.jsx(container.Container,{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:o||s()});case "label-only":return jsxRuntime.jsxs(container.Container,{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:[l,s()]});case "icon-label":return jsxRuntime.jsxs(container.Container,{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:[l,o,s()]});case "label-icon":default:return jsxRuntime.jsxs(container.Container,{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:[o,l,s()]})}},K=(()=>{switch(i){case "hover":return {onMouseEnter:$,onMouseLeave:k};case "both":return {onClick:j,onMouseEnter:$,onMouseLeave:k};case "click":default:return {onClick:j}}})();return jsxRuntime.jsxs("div",{ref:o=>{E=o;},className:"dropdown relative inline-block",...i==="hover"||i==="both"?{onMouseEnter:$,onMouseLeave:k}:{},children:[jsxRuntime.jsx(button.Button,{variant:b,color:u,size:t,className:`${e.className||""} ${e.buttonClassName||""} w-full`,...K,fullWidth:true,labelFullWidth:true,children:jsxRuntime.jsx(container.Container,{as:"span",w:"full",justify:"between",display:"inline-flex",align:"center",gap:e.gap??2,children:typeof e.trigger=="string"?G():e.trigger})}),jsxRuntime.jsx(ee,{as:"div",display:"flex",direction:"column",className:`
                        dropdown-menu
                        absolute
                        ${D[n].menu}
                        ${_[r]}
                        hidden
                        bg-surface
                        shadow-lg
                        z-50
                        py-1
                        ${C==="partof"?"w-full min-w-fit rounded-none border-x border-b border-1 mt-0":`w-full min-w-fit rounded-md border border-1 ${n==="down"?"mt-2":""} ${n==="up"?"mb-2":""}`}
                    `,ref:o=>{a=o;},children:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[C==="arrow"&&e.labelArrow&&jsxRuntime.jsx("div",{ref:o=>{v=o;},className:`
                                        absolute
                                        ${D[n].arrow}
                                    `,style:F}),e.options.flatMap((o,s)=>{let l=[];o.divider?l.push(jsxRuntime.jsx(divider.Divider,{color:"1",opacity:50,max:100,thickness:"super-thin",className:"my-1"})):l.push(jsxRuntime.jsx(button.Button,{variant:"ghost",color:u,size:t,fullWidth:true,className:`
                                                dropdown-option
                                                justify-start
                                                text-base
                                                text-1
                                                whitespace-nowrap
                                                ${o.disabled?"opacity-50 cursor-not-allowed pointer-events-none":""}
                                            `,onClick:()=>q(o.value,o.disabled),disabled:o.disabled,leftIcon:o.icon,type:"button",children:o.label}));let w=e.options[s+1];return e.autoDivider&&s<e.options.length-1&&!o.divider&&(!w||!w.divider)&&l.push(jsxRuntime.jsx(divider.Divider,{color:"1",opacity:50,max:100,thickness:"super-thin",className:"my-1"})),l})]})})]})}exports.Dropdown=me;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map