'use strict';var container=require('@cruxkit/container'),button=require('@cruxkit/button'),text=require('@cruxkit/text'),icon=require('@cruxkit/icon'),jsxRuntime=require('@minejs/jsx/jsx-runtime');var b=null;function I(r){let e=r,t=new Set;function n(){return b&&t.add(b),e}function o(d){Object.is(e,d)||(e=d,t.forEach(s=>s()));}function m(d){o(d(e));}function c(){return e}function C(d){return t.add(d),()=>t.delete(d)}let h=n;return h.set=o,h.update=m,h.peek=c,h.subscribe=C,h}function w(r){let e,t=false,n=()=>{if(t)return;e&&(e(),e=void 0);let m=b;b=n;try{let c=r();typeof c=="function"&&(e=c);}finally{b=m;}};n();let o=()=>{t||(t=true,e&&e());};return o}var $=class{constructor(){this.instances=I([]);}register(e,t,n=null){let o=this.calculateLevel(n),m={id:e,parentId:n,close:t,level:o};this.instances.update(c=>[...c,m]);}unregister(e){this.instances.update(t=>t.filter(n=>n.id!==e));}open(e){let t=this.instances().find(o=>o.id===e);if(!t){console.warn("[DropdownManager] Cannot open - dropdown not found:",e);return}this.instances().filter(o=>o.id!==e&&o.level===t.level&&o.parentId===t.parentId).forEach(o=>{o.close();});}close(e){let t=this.instances().find(o=>o.id===e);if(!t)return;this.getChildren(e).forEach(o=>{o.close();}),t.close();}closeFromLevel(e){this.instances().filter(n=>n.level>=e).forEach(n=>{n.close();});}getChildren(e){let t=this.instances().filter(o=>o.parentId===e),n=[...t];return t.forEach(o=>{n.push(...this.getChildren(o.id));}),n}calculateLevel(e){if(!e)return 0;let t=this.instances().find(n=>n.id===e);return t?t.level+1:0}isAncestor(e,t){let n=this.instances().find(o=>o.id===t);for(;n&&n.parentId;){if(n.parentId===e)return  true;n=this.instances().find(o=>o.id===n.parentId);}return  false}getRootParent(e){let t=this.instances().find(n=>n.id===e);for(;t&&t.parentId;)t=this.instances().find(n=>n.id===t.parentId);return t||null}debug(){console.log("[DropdownManager] Registered dropdowns:",this.instances());}},p=new $;var R={sm:{text:"sm",paddingX:3,paddingY:1},md:{text:"md",paddingX:4,paddingY:2},lg:{text:"lg",paddingX:5,paddingY:3}},q={start:"start-0",center:"start-1/2 -translate-x-1/2",end:"end-0"},H={down:{menu:"top-full",arrow:"bottom-full mb-1"},up:{menu:"bottom-full",arrow:"top-full mt-1"},side:{menu:"top-0 start-full ms-2",arrow:"top-1/2 end-full me-1 -translate-y-1/2"}},G=container.Container;function se(r){let e=r.size||"md",t=r.position||"end",n=r.direction||"down",o=r.triggerMode||"click",m=r.triggerDisplay||"label-icon",c=r.hoverDelay||150,C=r.styleMode||"arrow",h=r.variant||"ghost",d=r.color||"neutral",s=r.id||`dropdown-${Math.random().toString(36).substr(2,9)}`,O=r.parentId||null,u=I(false),g=null,x=null,M=null,v=null;w(()=>{r.onOpenChange?.(u());});let f=6,D={width:"0",height:"0"};n==="up"?D={width:"0",height:"0",borderLeft:`${f}px solid transparent`,borderRight:`${f}px solid transparent`,borderBottom:`${f}px solid var(--bg-surface)`,borderTop:"0"}:n==="side"?D={width:"0",height:"0",borderTop:`${f}px solid transparent`,borderBottom:`${f}px solid transparent`,borderInlineStart:`${f}px solid var(--bg-surface)`,borderInlineEnd:"0"}:D={width:"0",height:"0",borderLeft:`${f}px solid transparent`,borderRight:`${f}px solid transparent`,borderTop:`${f}px solid var(--bg-surface)`,borderBottom:"0"},p.register(s,()=>{u.set(false);},O),w(()=>()=>{p.unregister(s),g&&clearTimeout(g);}),w(()=>{if(!u())return;let l=E=>{M&&!M.contains(E.target)&&p.close(s);};return document.addEventListener("click",l),()=>{document.removeEventListener("click",l);}});let z=i=>{i.stopPropagation(),!u()?(p.open(s),u.set(true)):p.close(s);},T=()=>{g&&clearTimeout(g),g=setTimeout(()=>{p.open(s),u.set(true);},c);},S=()=>{g&&clearTimeout(g),g=setTimeout(()=>{p.close(s);},c);},B=(i,l)=>{l||(r.onSelect?.(i),p.close(s));};w(()=>{let i=u();v&&(i?(v.classList.remove("hidden"),v.classList.add("flex")):(v.classList.remove("flex"),v.classList.add("hidden")));}),w(()=>{let i=u();x&&(i?x.classList.add("rotate-180"):x.classList.remove("rotate-180"));});let X=()=>{let i=r.triggerIcon?typeof r.triggerIcon=="string"?jsxRuntime.jsx(icon.Icon,{name:r.triggerIcon,size:"md"}):jsxRuntime.jsx(icon.Icon,{...r.triggerIcon}):null,l=()=>r.labelArrow?jsxRuntime.jsx("span",{ref:J=>{x=J;},className:"transition-transform duration-200",children:jsxRuntime.jsx(icon.Icon,{name:"chevron-down",size:"sm"})}):null,E=typeof r.trigger=="string"?jsxRuntime.jsx(text.Text,{as:"span",size:R[e].text,children:r.trigger}):r.trigger;switch(m){case "icon-only":return jsxRuntime.jsx(container.Container,{as:"span",display:"inline-flex",align:"center",gap:1,children:i||l()});case "label-only":return jsxRuntime.jsxs(container.Container,{as:"span",display:"inline-flex",align:"center",gap:2,children:[E,l()]});case "label-icon":default:return jsxRuntime.jsxs(container.Container,{as:"span",display:"inline-flex",align:"center",gap:2,children:[i,E,l()]})}},A=(()=>{switch(o){case "hover":return {onMouseEnter:T,onMouseLeave:S};case "both":return {onClick:z,onMouseEnter:T,onMouseLeave:S};case "click":default:return {onClick:z}}})(),Y=R[e];return jsxRuntime.jsxs("div",{ref:i=>{M=i;},className:"dropdown relative inline-block",...o==="hover"||o==="both"?{onMouseEnter:T,onMouseLeave:S}:{},children:[jsxRuntime.jsx(button.Button,{variant:h,color:d,size:e,className:r.className,...A,children:jsxRuntime.jsx(container.Container,{as:"span",display:"inline-flex",align:"center",gap:Y.text==="sm"?1:2,children:typeof r.trigger=="string"?X():r.trigger})}),jsxRuntime.jsx(G,{as:"div",display:"flex",direction:"column",className:`
                        dropdown-menu
                        absolute
                        ${H[n].menu}
                        ${q[t]}
                        hidden
                        bg-surface
                        shadow-lg
                        z-50
                        py-1
                        ${C==="partof"?"w-full min-w-fit rounded-none border-x border-b border-1 mt-0":`w-full min-w-fit rounded-md border border-1 ${n==="down"?"mt-2":""} ${n==="up"?"mb-2":""}`}
                    `,ref:i=>{v=i,i&&setTimeout(()=>{u()?(i.classList.remove("hidden"),i.classList.add("flex")):(i.classList.remove("flex"),i.classList.add("hidden"));},0);},children:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[C==="arrow"&&r.labelArrow&&jsxRuntime.jsx("div",{className:`
                                        absolute
                                        ${H[n].arrow}
                                    `,style:D}),r.options.map((i,l)=>i.divider?jsxRuntime.jsx("div",{className:"h-px bg-1 opacity-20 my-1",role:"separator"},"divider-"+l):jsxRuntime.jsx(button.Button,{variant:"ghost",color:d,size:e,fullWidth:true,className:`
                                            dropdown-option
                                            justify-start
                                            text-base
                                            text-1
                                            whitespace-nowrap
                                            ${i.disabled?"opacity-50 cursor-not-allowed pointer-events-none":""}
                                        `,onClick:()=>B(i.value,i.disabled),disabled:i.disabled,leftIcon:i.icon,type:"button",children:i.label}))]})})]})}exports.Dropdown=se;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map